<script>
  google.charts.load('current', {'packages':['table']});
  google.charts.setOnLoadCallback(drawTable);

  function drawTable() {
    var query = new google.visualization.Query(
      'https://docs.google.com/spreadsheets/d/1FCmVBTGtapBsZYxZMuFSjVIKF1L0n22V8ykT6T64oqw/gviz/tq?sheet=Antrean TENS&range=A1:J100'
    );
    query.send(handleQueryResponse);
  }

  function handleQueryResponse(response) {
    if (response.isError()) {
      console.error('Error: ' + response.getMessage() + ' ' + response.getDetailedMessage());
      return;
    }

    var fullData = response.getDataTable();
    var filteredData = new google.visualization.DataTable();

    // Header
    filteredData.addColumn('string', 'Timestamp');
    filteredData.addColumn('string', 'Nama Pasien');
    filteredData.addColumn('string', 'Nomor Urut');
    filteredData.addColumn('string', 'Nama Fisioterapis');
    filteredData.addColumn('string', 'Kode Alat');
    filteredData.addColumn('string', 'Status');
    filteredData.addColumn('string', 'Waktu Mulai');
    filteredData.addColumn('string', 'Waktu Selesai');
    filteredData.addColumn('string', 'Sisa Waktu');
    filteredData.addColumn('string', 'Nomor Kamar');

    // index kolom di sheet
    for (var i = 0; i < fullData.getNumberOfRows(); i++) {
      filteredData.addRow([
        fullData.getValue(i, 0), // Timestamp A
        fullData.getValue(i, 1), // Nama Pasien B
        fullData.getValue(i, 2), // Nomor Urut C
        fullData.getValue(i, 3), // Nama Fisioterapis D
        fullData.getValue(i, 4), // Kode Alat E
        fullData.getValue(i, 5), // Status F
        fullData.getValue(i, 6), // Waktu Mulai G
        fullData.getValue(i, 7), // Waktu Selesai H
        fullData.getValue(i, 8), // Sisa Waktu I
        fullData.getValue(i, 9)  // Nomor Kamar J
      ]);
    }

    var table = new google.visualization.Table(document.getElementById('table_div'));
    table.draw(filteredData, {
      allowHtml: true,
      showRowNumber: true,
      width: '100%',
      height: '100%'
     allowHtml: true // ini penting agar warna/status styled tampil
      });
    }

    // Auto-refresh setiap 1 detik
    setInterval(drawTable, 10000);
  </script>
</head>
<body>
  <h2 style="text-align:center">ðŸ“Š Antrean TENS Fisioterapi-RSUP Dr.M.Djamil Padang</h2>
  <div id="table_div" style="width:95%; margin:20px auto;"></div>
</body>
</html>
