function handleQueryResponse(response) {
  if (response.isError()) {
    console.error('Error: ' + response.getMessage() + ' ' + response.getDetailedMessage());
    return;
  }

  var data = response.getDataTable();

  // ðŸ“Œ Tentukan nomor kolom (A=0, B=1, C=2, dst.)
  var statusCol = 5;      // Kolom F (Status)
  var asalCol = 6;        // ðŸ”§ PERBAIKAN: Kolom G (Asal Selesai). Ganti jika perlu!
  var sisaWaktuCol = 8;   // Kolom I (Sisa Waktu)

  // Loop setiap baris â†’ ubah warna & isi sesuai status
  for (var i = 0; i < data.getNumberOfRows(); i++) {
    var status = data.getValue(i, statusCol);
    // ðŸ”§ PERBAIKAN: Baca nilai dari kolom 'asal' untuk baris ini
    var asal = data.getValue(i, asalCol); 

    if (status === "Dalam Menunggu") {
      data.setProperty(i, statusCol, 'style',
        'background-color:#E57373; color:white; font-weight:bold;');
    } else if (status === "Sedang Dilayani") {
      data.setProperty(i, statusCol, 'style',
        'background-color:#FFF176; color:black; font-weight:bold;');
    } else if (status === "Selesai") {
      // Cek 'asal' yang nilainya sudah kita ambil dari Google Sheet
      if (asal && asal.toString().toLowerCase() === "manual") {
        // kalau manual klik selesai
        data.setValue(i, sisaWaktuCol, "Selesai");
      } else {
        // default atau auto timer habis
        data.setValue(i, sisaWaktuCol, "Waktu Habis");
      }
      data.setProperty(i, statusCol, 'style',
        'background-color:#81C784; color:white; font-weight:bold;');
      data.setProperty(i, sisaWaktuCol, 'style',
        'background-color:#81C784; color:white; font-weight:bold;');
    } else if (status === "Cancel") {
      data.setValue(i, sisaWaktuCol, "Dibatalkan");
      data.setProperty(i, statusCol, 'style',
        'background-color:#000000; color:white; font-weight:bold;');
      data.setProperty(i, sisaWaktuCol, 'style',
        'background-color:#000000; color:white; font-weight:bold;');
    }
  }

  var table = new google.visualization.Table(document.getElementById('table_div'));
  table.draw(data, {
    showRowNumber: true,
    width: '100%',
    height: '100%',
    allowHtml: true
  });
}
